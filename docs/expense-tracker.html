<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Expense Tracker â€” Browser Demo</title>
  <style>
    :root { --gap: 12px; --muted: #666; --bd: #e5e7eb; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; }
    h1 { margin: 0 0 16px; }
    .row { display: flex; flex-wrap: wrap; gap: var(--gap); align-items: center; margin-bottom: var(--gap); }
    input, button, select { padding: 8px 10px; font-size: 14px; }
    button { cursor: pointer; }
    .card { border: 1px solid var(--bd); padding: 16px; border-radius: 8px; margin-bottom: 16px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid var(--bd); padding: 8px; text-align: left; }
    th { background: #f8fafc; }
    .right { text-align: right; }
    .muted { color: var(--muted); }
    .helper { font-size: 12px; color: var(--muted); margin-top: 4px; }
    .section-title { margin: 0 0 8px; font-size: 16px; }
  </style>
  </head>
  <body>
    <h1>Expense Tracker (Browser Demo)</h1>

    <div class="grid">
      <div class="card">
        <div class="section-title">Add</div>
        <div class="row">
          <input id="desc" placeholder="Description (e.g., Lunch)" />
          <input id="amount" type="number" step="0.01" placeholder="Amount (e.g., 12.50)" />
          <button id="addBtn">Add</button>
        </div>
        <div class="helper">Equivalent to: expense-tracker add --description "..." --amount 12.5</div>
      </div>

      <div class="card">
        <div class="section-title">Update</div>
        <div class="row">
          <input id="updateId" type="number" placeholder="ID to update" />
          <input id="newDesc" placeholder="New description (optional)" />
          <input id="newAmount" type="number" step="0.01" placeholder="New amount (optional)" />
          <button id="updateBtn">Update</button>
        </div>
        <div class="helper">Equivalent to: expense-tracker update --id 1 [--description "..."] [--amount 9.99]</div>
      </div>

      <div class="card">
        <div class="section-title">Delete</div>
        <div class="row">
          <input id="deleteId" type="number" placeholder="ID to delete" />
          <button id="deleteBtn">Delete</button>
        </div>
        <div class="helper">Equivalent to: expense-tracker delete --id 1</div>
      </div>

      <div class="card">
        <div class="section-title">Summary</div>
        <div class="row">
          <select id="month">
            <option value="">All months</option>
            <option value="1">January</option>
            <option value="2">February</option>
            <option value="3">March</option>
            <option value="4">April</option>
            <option value="5">May</option>
            <option value="6">June</option>
            <option value="7">July</option>
            <option value="8">August</option>
            <option value="9">September</option>
            <option value="10">October</option>
            <option value="11">November</option>
            <option value="12">December</option>
          </select>
          <button id="summaryBtn">Show Summary</button>
          <span id="summaryText" class="muted"></span>
        </div>
        <div class="helper">Equivalent to: expense-tracker summary [--month N]</div>
      </div>
    </div>

    <div class="card">
      <div class="section-title">Expenses</div>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Date</th>
            <th>Description</th>
            <th class="right">Amount</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>

    <script>
      // In-memory store to mirror CLI behavior conceptually
      let expenses = [];

      function todayIsoDate() {
        const now = new Date();
        const yyyy = now.getFullYear();
        const mm = String(now.getMonth() + 1).padStart(2, '0');
        const dd = String(now.getDate()).padStart(2, '0');
        return `${yyyy}-${mm}-${dd}`;
      }

      function generateNextId(items) {
        let maxId = 0;
        for (const it of items) {
          if (typeof it.id === 'number' && it.id > maxId) maxId = it.id;
        }
        return maxId + 1;
      }

      function render() {
        const tbody = document.getElementById('tbody');
        tbody.innerHTML = '';
        for (const e of expenses) {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${e.id}</td>
            <td>${e.date}</td>
            <td>${e.description}</td>
            <td class="right">$${Number(e.amount).toFixed(2)}</td>
          `;
          tbody.appendChild(tr);
        }
      }

      // add
      document.getElementById('addBtn').addEventListener('click', () => {
        const desc = document.getElementById('desc').value.trim();
        const amount = Number(document.getElementById('amount').value);
        if (!desc) { alert('Description is required'); return; }
        if (!Number.isFinite(amount) || amount <= 0) { alert('Amount must be positive'); return; }
        expenses.push({ id: generateNextId(expenses), date: todayIsoDate(), description: desc, amount: Number(amount.toFixed(2)) });
        render();
      });

      // update
      document.getElementById('updateBtn').addEventListener('click', () => {
        const id = Number(document.getElementById('updateId').value);
        const newDesc = document.getElementById('newDesc').value;
        const newAmtStr = document.getElementById('newAmount').value;
        if (!Number.isInteger(id)) { alert('Invalid ID'); return; }
        const idx = expenses.findIndex(e => e.id === id);
        if (idx === -1) { alert('Expense not found'); return; }
        if (newDesc !== '') expenses[idx].description = newDesc.trim();
        if (newAmtStr !== '') {
          const amt = Number(newAmtStr);
          if (!Number.isFinite(amt) || amt <= 0) { alert('Invalid amount'); return; }
          expenses[idx].amount = Number(amt.toFixed(2));
        }
        render();
      });

      // delete
      document.getElementById('deleteBtn').addEventListener('click', () => {
        const id = Number(document.getElementById('deleteId').value);
        if (!Number.isInteger(id)) { alert('Invalid ID'); return; }
        const idx = expenses.findIndex(e => e.id === id);
        if (idx === -1) { alert('Expense not found'); return; }
        expenses.splice(idx, 1);
        render();
      });

      // summary
      document.getElementById('summaryBtn').addEventListener('click', () => {
        const monthSel = document.getElementById('month').value;
        const summaryText = document.getElementById('summaryText');
        const total = (list) => list.reduce((s, e) => s + Number(e.amount || 0), 0);
        if (monthSel) {
          const year = new Date().getFullYear();
          const mm = String(Number(monthSel)).padStart(2, '0');
          const filtered = expenses.filter(e => String(e.date).startsWith(`${year}-${mm}`));
          const sum = total(filtered);
          const monthName = new Date(year, Number(monthSel) - 1, 1).toLocaleString('en', { month: 'long' });
          summaryText.textContent = `Total expenses for ${monthName}: $${sum.toFixed(2)}`;
        } else {
          summaryText.textContent = `Total expenses: $${total(expenses).toFixed(2)}`;
        }
      });

      render();
    </script>
  </body>
  </html>


